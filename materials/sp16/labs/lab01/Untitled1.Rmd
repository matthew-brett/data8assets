---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.2.4
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import numpy as np
np.set_printoptions(threshold=50, linewidth=50)
from datascience import *
```

```{python}
url = 'http://www.census.gov/popest/data/national/asrh/2014/files/NC-EST2014-AGESEX-RES.csv'
full = Table.read_table(url)
full
```

```{python}
partial = full.select(['SEX', 'AGE', 4, 8])
partial
```

```{python}
simple = partial.relabeled('POPESTIMATE2010', '2010').relabeled(3, '2014')
simple
```

```{python}
census = simple.with_columns([
        'Change', simple.column(3) - simple.column(2), 
        'Growth', (simple.column(3) / simple.column(2)) ** (1/4) - 1])
census
```

```{python}
census.set_format('Growth', PercentFormatter)
census.set_format([2, 3, 4], NumberFormatter)
```

```{python}
max(census.column(1))
```

```{python}
totals = census.where('AGE', 999)
totals
```

```{python}
totals.group(1)
```

```{python}
totals.take([1, 2])
```

```{python}
totals = census.where('AGE', 999)
totals
```

```{python}
totals = totals.drop(totals.take([1, 2]))

```

```{python}
totals
```

```{python}
totals = census.where('AGE', 999)
totals
```

```{python}
totals.drop(totals.take(2))
```

```{python}
no_sums = census.where(np.logical_and(census.column('AGE') < 999,
                                      census.column('SEX') > 0))
no_sums.show()
#pivoted = no_sums.pivot('SEX', 'AGE', '2014', sum)
```

```{python}
no_sums.pivot('SEX', 'AGE', '2014',sum)
```

```{python}

```
