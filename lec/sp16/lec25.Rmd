---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.2.4
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import numpy as np
from datascience import *

# Configure notebook (happens automatically on data8.berkeley.edu)
# %matplotlib inline
import matplotlib.pyplot as plt
plt.style.use('fivethirtyeight')

# Configure for presentation
np.set_printoptions(threshold=50, linewidth=50)
import matplotlib as mpl
mpl.rc('font', size=16)
```

```{python}
free_trips = Table.read_table("trip.csv").where('Duration', are.below(1800)).select([3, 6, 1])
free_trips
```

```{python}
np.average(free_trips.column('Duration'))
```

```{python}
n = 100
samples = Table(['Sample #', 'Duration'])
for i in np.arange(40):
    for trip in free_trips.sample(n).rows:
        samples.append([i, trip.item('Duration')])
samples
```

```{python}
for i in np.arange(3):
    avg = np.average(samples.where(0, i).column(1))
    print("Sample", i, "average is", avg)
```

```{python}
samples.group(0, np.average).scatter(0, 1, s=50)
```

```{python}
samples.group(0, np.average).hist(1)
```

```{python}
averages = np.sort(samples.group(0, np.average).column(1))
lower = averages.item(1)
upper = averages.item(38)
print('Empirically, 95% within', lower, 'to', upper)
```

```{python}
max_deviation = np.ceil(max(550-lower, upper-550))
print('Empirically, the sample average is 550 +/-', max_deviation, 'for 95% of samples')
```

```{python}
samples.where('Sample #', 0).hist(1)
samples.where('Sample #', 1).hist(1)
```

```{python}
free_trips.hist(2)
```

### Resampling

```{python}
sample = samples.where("Sample #", 0)
sample_average = np.average(sample.column('Duration'))
sample_average
```

```{python}
resamples = Table(['Resample #', 'Duration'])
for i in np.arange(40):
    for trip in sample.sample(n, with_replacement=True).rows:
        resamples.append([i, trip.item('Duration')])
resamples
```

```{python}
resamples.group(0, np.average).scatter(0, 1, s=50)
```

```{python}
resamples.group(0, np.average).hist(1, bins=np.arange(480, 641, 10))
```
