---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.2.4
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
from datascience import *
import numpy as np

# %matplotlib inline
import matplotlib.pyplot as plots
plots.style.use('fivethirtyeight')

# Configure for presentation
np.set_printoptions(threshold=50, linewidth=50)
import matplotlib as mpl
mpl.rc('font', size=16)
```

## Drinks

```{python}
drinks = Table(['Drink', 'Cafe', 'Price']).with_rows([
    ['Milk Tea', 'Tea One', 4],
    ['Espresso', 'Nefeli',  2],
    ['Latte',    'Nefeli',  3],
    ['Espresso', "Abe's",   2]
])
drinks
```

```{python}
discounts = Table().with_columns(
    'Coupon % off', make_array(25, 50, 5),
    'Location', make_array('Tea One', 'Nefeli', 'Tea One')
)
discounts
```

```{python}
t = drinks.join('Cafe', discounts, 'Location')
t
```

```{python}
t.with_column('Discounted', t.column(2) * (1 - t.column(3)/ 100))
```

## Bikes

```{python}
trips = Table.read_table('trip.csv')
trips
```

```{python}
commute = trips.where('Duration', are.below(1800))
commute.hist('Duration')
```

```{python}
commute.hist('Duration', bins=60, unit='second')
```

```{python}
(550-250) * 0.15
```

```{python}
commute.hist('Duration', bins=np.arange(1801), unit='second')
```

```{python}
starts = commute.group('Start Station').sort('count', descending=True)
starts
```

```{python}
commute.pivot('Start Station', 'End Station')
```

```{python}
duration = trips.select(3, 6, 1)
duration
```

```{python}
shortest = duration.group([0, 1], min)
shortest
```

```{python}
from_cc = shortest.where(0, are.containing('Civic Center BART')).sort(2)
from_cc
```

## Maps

```{python}
stations = Table.read_table('station.csv')
stations
```

```{python}
Marker.map_table(stations.select('lat', 'long', 'name'))
```

```{python}
sf = stations.where('landmark', 'San Francisco')
Circle.map_table(sf.select('lat', 'long', 'name'), color='green', radius=150)
```

```{python}
from_cc
```

```{python}
colors = stations.group('landmark').with_column(
    'color', make_array('blue', 'red', 'green', 'orange', 'purple'))
colors
```

```{python}
colored = stations.join('landmark', colors).select('lat', 'long', 'name', 'color')
Marker.map_table(colored)
```

```{python}
station_starts = stations.join('name', starts, 'Start Station')
station_starts
```

```{python}
Circle.map_table(station_starts.select('lat', 'long', 'name').with_columns(
    'color', 'blue',
    'area', station_starts.column('count') * 1000
))
```
