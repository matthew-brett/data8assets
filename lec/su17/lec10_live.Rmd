---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.2.4
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
from datascience import *
import numpy as np

# %matplotlib inline
import matplotlib.pyplot as plots
plots.style.use('fivethirtyeight')

from ipywidgets import interact, interactive, fixed, interact_manual
import ipywidgets as widgets
```

```{python}
abs(-2)
```

```{python}
max(1, 2, 3)
```

```{python}
100 * (9/5) + 32
```

```{python}
0 * (9/5) + 32
```

```{python}
21 * (9/5) + 32
```

```{python}
def fahrenheit(x):
    return x * (9/5) + 32
```

```{python}
fahrenheit(100)
```

```{python}
fahrenheit(0)
```

```{python}
y = 100
fahrenheit(y/4)
```

```{python}
x
```

```{python}
x
```

```{python}
counts = make_array(1, 2, 3)
total = counts.sum()
np.round(counts / total * 100, 2)
```

```{python}
def percents(counts):
    """ Converts counts to percents out of the total. """
    total = counts.sum()
    return np.round(counts / total * 100, 3)
```

```{python}
percents(make_array(2, 4, 6))
```

```{python}
def percents(counts, decimal_places=2):
    """ Converts counts to percents out of the total. """
    total = counts.sum()
    return np.round(counts / total * 100, decimal_places)
```

```{python}
percents(make_array(2, 4, 6))
```

```{python}
percents(make_array(1, 3, 10))
```

```{python}
percents(make_array(2, 4, 6), 1)
```

## Apply

```{python}
def cut_off_at_a_billion(x):
    '''The smaller of x and 1,000,000,000'''
    return min(x, 1e9)
```

```{python}
cut_off_at_a_billion(123)
```

```{python}
cut_off_at_a_billion(1230000000000000)
```

```{python}
top = Table.read_table('http://inferentialthinking.com/notebooks/top_movies.csv').where('Studio', 'Fox')
top
```

```{python}
cut_off_at_a_billion(top.column(3).item(0))
```

```{python}
cut_off_at_a_billion(top.column(3))
```

```{python}
cut_off_at_a_billion(123000000000)
```

```{python}
cut_off = top.apply(cut_off_at_a_billion, 'Gross (Adjusted)')
cut_off
```

```{python}
top.with_column('Cut Off', cut_off)
```

```{python}
type(cut_off_at_a_billion)
```

```{python}
cut_off_at_a_billion?
```

```{python}

```

## Predictions

```{python}
galton = Table.read_table('http://inferentialthinking.com/notebooks/galton.csv')
galton
```

```{python}
galton.select(1, 2, 7).hist()
```

```{python}
heights = galton.select(3, 7).relabeled(0, 'MidParent').relabeled(1, 'Child')
heights
```

```{python}
heights.scatter(0)
```

```{python}
close_to_68 = heights.where('MidParent', are.between(67.5, 68.5))
close_to_68
```

```{python}
close_to_68.column('Child').mean()
```

```{python}
heights.scatter('MidParent')
_ = plots.plot([67.5, 67.5], [50, 85], color='red', lw=2)
_ = plots.plot([68.5, 68.5], [50, 85], color='red', lw=2)
_ = plots.scatter(68, 66.24, color='gold', s=40)
```

```{python}
def predict_child(mp):
    close = heights.where('MidParent', are.between(mp - 0.5, mp + 0.5))
    return close.column('Child').mean()
```

```{python}
predict_child(70)
```

```{python}
heights_with_predictions = heights.with_columns(
    'Prediction', heights.apply(predict_child, 'MidParent')
)
heights_with_predictions
```

```{python}

```

```{python}

```
